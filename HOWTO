# –†–£–ö–û–í–û–î–°–¢–í–û –ü–û –†–ï–ê–õ–ò–ó–ê–¶–ò–ò DEPLOY-STAND

## –û–ë–ó–û–† –ü–†–û–ï–ö–¢–ê

Deploy-Stand - —ç—Ç–æ –º–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ Proxmox VE. –°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –≥–¥–µ –∫–∞–∂–¥—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –±–ª–æ–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–∞–∫ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –º–æ–¥—É–ª—å.

## –ú–û–î–£–õ–¨–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –º–æ–¥—É–ª—å–Ω–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞:
- **–ò–∑–æ–ª—è—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞**: –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –æ–±–ª–∞—Å—Ç—å
- **–ß–µ—Ç–∫–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã**: –ú–æ–¥—É–ª–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç —á–µ—Ä–µ–∑ —Å—Ç—Ä–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã
- **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å**: –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–º –º–æ–¥—É–ª–µ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –¥—Ä—É–≥–∏–µ
- **–ü–æ–¥–∫–ª—é—á–∞–µ–º–æ—Å—Ç—å**: –ú–æ–¥—É–ª–∏ –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å/—É–¥–∞–ª—è—Ç—å/–∑–∞–º–µ–Ω—è—Ç—å
- **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π:
```
deploy-stand/
‚îú‚îÄ‚îÄ core/                          # –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ interfaces/                # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –º–æ–¥—É–ª–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deployment_interface.py    # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ balancing_interface.py    # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ template_interface.py     # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–∞–º–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ network_interface.py      # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–µ—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ modules/                   # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥—É–ª–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deployment/            # –ú–æ–¥—É–ª—å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ basic_deployer.py     # –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞—Ç–µ–ª—å
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ advanced_deployer.py  # –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞—Ç–µ–ª—å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ balancing/             # –ú–æ–¥—É–ª—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ simple_balancer.py    # –ü—Ä–æ—Å—Ç–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ smart_balancer.py     # –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ templates/             # –ú–æ–¥—É–ª—å —à–∞–±–ª–æ–Ω–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ local_templates.py    # –õ–æ–∫–∞–ª—å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ migration_templates.py # –ú–∏–≥—Ä–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ network/               # –ú–æ–¥—É–ª—å —Å–µ—Ç–∏
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ bridge_manager.py     # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ bridge'–∞–º–∏
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ interface_config.py   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ config/                    # –ú–æ–¥—É–ª—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validators.py
‚îÇ   ‚îú‚îÄ‚îÄ users/                     # –ú–æ–¥—É–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_manager.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pool_manager.py
‚îÇ   ‚îî‚îÄ‚îÄ proxmox/                   # –ú–æ–¥—É–ª—å Proxmox API
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ proxmox_client.py
‚îÇ       ‚îî‚îÄ‚îÄ api_wrapper.py
‚îú‚îÄ‚îÄ ui/                            # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ cli/                       # CLI –º–æ–¥—É–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ menu_system.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ command_handler.py
‚îÇ   ‚îî‚îÄ‚îÄ validators/                # –í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –≤–≤–æ–¥–∞
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ input_validators.py
‚îú‚îÄ‚îÄ utils/                         # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ logging/                   # –ú–æ–¥—É–ª—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logger.py
‚îÇ   ‚îú‚îÄ‚îÄ caching/                   # –ú–æ–¥—É–ª—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cache_manager.py
‚îÇ   ‚îî‚îÄ‚îÄ monitoring/                # –ú–æ–¥—É–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ metrics.py
‚îî‚îÄ‚îÄ main.py                        # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

## –ò–ù–¢–ï–†–§–ï–ô–°–´ –ú–û–î–£–õ–ï–ô

### 1. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (core/interfaces/deployment_interface.py)
```python
from abc import ABC, abstractmethod
from typing import Dict, List, Any

class DeploymentInterface(ABC):
    """–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –º–æ–¥—É–ª–µ–π —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω"""

    @abstractmethod
    def deploy_configuration(self, users: List[str], config: Dict[str, Any],
                           node_selection: str = "auto", target_node: str = None) -> Dict[str, str]:
        """
        –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω

        Args:
            users: –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
            config: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
            node_selection: –°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤—ã–±–æ—Ä–∞ –Ω–æ–¥—ã ("auto", "specific", "balanced")
            target_node: –¶–µ–ª–µ–≤–∞—è –Ω–æ–¥–∞ (–µ—Å–ª–∏ node_selection="specific")

        Returns:
            –°–ª–æ–≤–∞—Ä—å {–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: –ø–∞—Ä–æ–ª—å}
        """
        pass

    @abstractmethod
    def validate_config(self, config: Dict[str, Any]) -> bool:
        """–í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è"""
        pass

    @abstractmethod
    def get_deployment_status(self, deployment_id: str) -> Dict[str, Any]:
        """–ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è"""
        pass
```

### 2. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ (core/interfaces/balancing_interface.py)
```python
from abc import ABC, abstractmethod
from typing import Dict, List

class BalancingInterface(ABC):
    """–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –º–æ–¥—É–ª–µ–π –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏"""

    @abstractmethod
    def distribute_deployment(self, users: List[str], nodes: List[str],
                            config: Dict = None) -> Dict[str, List[str]]:
        """
        –†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –Ω–æ–¥–∞–º

        Args:
            users: –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            nodes: –î–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–æ–¥—ã
            config: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

        Returns:
            –°–ª–æ–≤–∞—Ä—å {–Ω–æ–¥–∞: [–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏]}
        """
        pass

    @abstractmethod
    def analyze_node_load(self, nodes: List[str]) -> Dict[str, Dict[str, float]]:
        """
        –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å –Ω–æ–¥

        Returns:
            –ú–µ—Ç—Ä–∏–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –Ω–æ–¥—ã
        """
        pass

    @abstractmethod
    def optimize_distribution(self, current_distribution: Dict[str, List[str]],
                            config: Dict = None) -> Dict[str, List[str]]:
        """–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ"""
        pass
```

### 3. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–∞–º–∏ (core/interfaces/template_interface.py)
```python
from abc import ABC, abstractmethod
from typing import Dict, List

class TemplateInterface(ABC):
    """–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –º–æ–¥—É–ª–µ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —à–∞–±–ª–æ–Ω–∞–º–∏"""

    @abstractmethod
    def prepare_templates_for_target_node(self, config: Dict[str, Any],
                                        node_selection: str, target_node: str) -> bool:
        """
        –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —à–∞–±–ª–æ–Ω—ã –¥–ª—è —Ü–µ–ª–µ–≤–æ–π –Ω–æ–¥—ã

        Args:
            config: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
            node_selection: –°—Ç—Ä–∞—Ç–µ–≥–∏—è –≤—ã–±–æ—Ä–∞ –Ω–æ–¥—ã
            target_node: –¶–µ–ª–µ–≤–∞—è –Ω–æ–¥–∞

        Returns:
            True –µ—Å–ª–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —É—Å–ø–µ—à–Ω–∞
        """
        pass

    @abstractmethod
    def create_local_template(self, template_node: str, template_vmid: int,
                            target_node: str, new_vmid: int) -> bool:
        """–°–æ–∑–¥–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —à–∞–±–ª–æ–Ω –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –Ω–æ–¥–µ"""
        pass

    @abstractmethod
    def get_template_mapping(self) -> Dict[str, int]:
        """–ü–æ–ª—É—á–∏—Ç—å mapping –ª–æ–∫–∞–ª—å–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤"""
        pass
```

### 4. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–µ—Ç–∏ (core/interfaces/network_interface.py)
```python
from abc import ABC, abstractmethod
from typing import Dict, List

class NetworkInterface(ABC):
    """–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –º–æ–¥—É–ª–µ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ç—å—é"""

    @abstractmethod
    def configure_network(self, vmid: int, node: str, networks: List[Dict],
                         pool: str, device_type: str = 'linux') -> bool:
        """
        –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã

        Args:
            vmid: ID –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã
            node: –ù–æ–¥–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è
            networks: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ç–µ–π
            pool: –ü—É–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            device_type: –¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

        Returns:
            True –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Å–ø–µ—à–Ω–∞
        """
        pass

    @abstractmethod
    def allocate_bridge(self, node: str, bridge_name: str, pool: str,
                       reserved: bool = False) -> str:
        """–í—ã–¥–µ–ª–∏—Ç—å bridge –¥–ª—è —Å–µ—Ç–∏"""
        pass

    @abstractmethod
    def cleanup_unused_bridges(self, nodes: List[str]) -> int:
        """–û—á–∏—Å—Ç–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ bridge'—ã"""
        pass
```

## –†–ï–ê–õ–ò–ó–ê–¶–ò–ò –ú–û–î–£–õ–ï–ô

### –ú–æ–¥—É–ª—å –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (core/modules/deployment/basic_deployer.py)
```python
from core.interfaces.deployment_interface import DeploymentInterface
from core.proxmox.proxmox_client import ProxmoxClient
from core.users.user_manager import UserManager
from core.templates.local_templates import LocalTemplateManager
from core.network.bridge_manager import BridgeManager

class BasicDeployer(DeploymentInterface):
    """–ë–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω"""

    def __init__(self, proxmox_client: ProxmoxClient, user_manager: UserManager,
                 template_manager: LocalTemplateManager, bridge_manager: BridgeManager):
        self.proxmox = proxmox_client
        self.user_manager = user_manager
        self.template_manager = template_manager
        self.bridge_manager = bridge_manager

    def deploy_configuration(self, users: List[str], config: Dict[str, Any],
                           node_selection: str = "auto", target_node: str = None) -> Dict[str, str]:
        """–ë–∞–∑–æ–≤–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ –æ–¥–Ω—É –Ω–æ–¥—É"""
        results = {}

        # –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ü–µ–ª–µ–≤—É—é –Ω–æ–¥—É
        nodes = self.proxmox.get_nodes()
        target_node = self._select_target_node(nodes, node_selection, target_node)

        # –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —à–∞–±–ª–æ–Ω—ã –¥–ª—è —Ü–µ–ª–µ–≤–æ–π –Ω–æ–¥—ã
        if not self.template_manager.prepare_templates_for_target_node(config, node_selection, target_node):
            raise DeploymentError("–û—à–∏–±–∫–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —à–∞–±–ª–æ–Ω–æ–≤")

        # –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        for user in users:
            user_result = self._deploy_for_user(user, config, target_node)
            results.update(user_result)

        return results

    def _deploy_for_user(self, user: str, config: Dict[str, Any], target_node: str) -> Dict[str, str]:
        """–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        # –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø—É–ª
        success, password = self.user_manager.create_user_and_pool(user)
        if not success:
            raise DeploymentError(f"–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user}")

        # –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã
        pool_name = user.split('@')[0]
        for machine_config in config['machines']:
            self._create_machine(machine_config, target_node, pool_name)

        return {user: password}
```

### –ú–æ–¥—É–ª—å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–π –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ (core/modules/balancing/smart_balancer.py)
```python
from core.interfaces.balancing_interface import BalancingInterface
from core.proxmox.proxmox_client import ProxmoxClient
from utils.monitoring.metrics import PerformanceMetrics
from utils.caching.cache_manager import CacheManager

class SmartBalancer(BalancingInterface):
    """–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ —Å –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º"""

    def __init__(self, proxmox_client: ProxmoxClient,
                 metrics: PerformanceMetrics, cache: CacheManager):
        self.proxmox = proxmox_client
        self.metrics = metrics
        self.cache = cache
        self.cache_ttl = 300  # 5 –º–∏–Ω—É—Ç

    def distribute_deployment(self, users: List[str], nodes: List[str],
                            config: Dict = None) -> Dict[str, List[str]]:
        """–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
        cache_key = f"distribution:{hash(str(users))}:{hash(str(nodes))}"

        # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–µ—à
        cached_result = self.cache.get(cache_key)
        if cached_result:
            return cached_result

        # –°–æ–±—Ä–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –Ω–æ–¥
        node_metrics = self.analyze_node_load(nodes)

        # –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –≤–µ—Å–∞ –Ω–æ–¥
        node_weights = self._calculate_node_weights(node_metrics, config)

        # –ü—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        user_demand = self._estimate_user_resource_demand(users, config)

        # –†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        distribution = self._intelligent_distribution(users, nodes, node_weights, user_demand)

        # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
        optimized_distribution = self._optimize_for_template_migration(distribution, config)

        # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∫–µ—à
        self.cache.set(cache_key, optimized_distribution, self.cache_ttl)

        return optimized_distribution

    def analyze_node_load(self, nodes: List[str]) -> Dict[str, Dict[str, float]]:
        """–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–æ–¥"""
        node_metrics = {}

        for node in nodes:
            metrics = {
                'vm_count': len(self.proxmox.get_vms_on_node(node)),
                'cpu_usage': self.proxmox.get_node_cpu_usage(node),
                'memory_usage': self.proxmox.get_node_memory_usage(node),
                'storage_available': self.proxmox.get_node_storage_available(node),
                'network_bandwidth': self._estimate_network_bandwidth(node),
                'active_templates': self._count_active_templates(node)
            }
            node_metrics[node] = metrics

        return node_metrics
```

### –ú–æ–¥—É–ª—å –ª–æ–∫–∞–ª—å–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤ (core/modules/templates/local_templates.py)
```python
from core.interfaces.template_interface import TemplateInterface
from core.proxmox.proxmox_client import ProxmoxClient
from utils.caching.cache_manager import CacheManager

class LocalTemplateManager(TemplateInterface):
    """–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω"""

    def __init__(self, proxmox_client: ProxmoxClient, cache: CacheManager):
        self.proxmox = proxmox_client
        self.cache = cache
        self.local_templates = {}  # –ö–µ—à –ª–æ–∫–∞–ª—å–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤

    def prepare_templates_for_target_node(self, config: Dict[str, Any],
                                        node_selection: str, target_node: str) -> bool:
        """–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —à–∞–±–ª–æ–Ω—ã –¥–ª—è —Ü–µ–ª–µ–≤–æ–π –Ω–æ–¥—ã"""
        try:
            # –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã
            self._load_local_templates_from_config()

            # –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç—Ä–µ–±—É–µ–º—ã–µ —à–∞–±–ª–æ–Ω—ã
            required_templates = self._analyze_template_requirements(config, node_selection, target_node)

            # –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —à–∞–±–ª–æ–Ω—ã
            for template_key, template_info in required_templates.items():
                if not self._is_template_available(template_key, target_node):
                    success = self.create_local_template(
                        template_info['template_node'],
                        template_info['template_vmid'],
                        target_node,
                        template_info['new_vmid']
                    )
                    if not success:
                        return False

            # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å mapping —à–∞–±–ª–æ–Ω–æ–≤
            self._save_template_mapping()
            return True

        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —à–∞–±–ª–æ–Ω–æ–≤: {e}")
            return False

    def create_local_template(self, template_node: str, template_vmid: int,
                            target_node: str, new_vmid: int) -> bool:
        """–°–æ–∑–¥–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —à–∞–±–ª–æ–Ω —á–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏—é"""
        try:
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π
            if not self._check_migration_resources(template_node, target_node):
                return False

            # –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω—ã–π –∫–ª–æ–Ω –Ω–∞ –∏—Å—Ö–æ–¥–Ω–æ–π –Ω–æ–¥–µ
            clone_task = self.proxmox.clone_vm(template_node, template_vmid, template_node,
                                             new_vmid, f"template-{template_vmid}-{target_node}", None, full_clone=True)

            # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —à–∞–±–ª–æ–Ω
            if not self.proxmox.wait_for_task(clone_task, template_node):
                return False

            self.proxmox.convert_to_template(template_node, new_vmid)

            # –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ —Ü–µ–ª–µ–≤—É—é –Ω–æ–¥—É –µ—Å–ª–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
            if template_node != target_node:
                migration_task = self.proxmox.migrate_vm(template_node, new_vmid, target_node)
                if not self.proxmox.wait_for_task(migration_task, template_node):
                    # –û—Ç–∫–∞—Ç
                    self.proxmox.delete_vm(template_node, new_vmid)
                    return False

            # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∫–µ—à
            template_key = f"{template_vmid}:{target_node}"
            self.local_templates[template_key] = new_vmid

            return True

        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —à–∞–±–ª–æ–Ω–∞: {e}")
            return False
```

### –ú–æ–¥—É–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è bridge'–∞–º–∏ (core/modules/network/bridge_manager.py)
```python
from core.interfaces.network_interface import NetworkInterface
from core.proxmox.proxmox_client import ProxmoxClient

class BridgeManager(NetworkInterface):
    """–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã–º–∏ bridge'–∞–º–∏"""

    def __init__(self, proxmox_client: ProxmoxClient):
        self.proxmox = proxmox_client
        self.bridge_cache = {}  # –ö–µ—à –≤—ã–¥–µ–ª–µ–Ω–Ω—ã—Ö bridge'–µ–π

    def configure_network(self, vmid: int, node: str, networks: List[Dict],
                         pool: str, device_type: str = 'linux') -> bool:
        """–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã"""
        try:
            # –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ bridge'—ã
            bridge_mapping = self._prepare_bridges(node, networks, pool)

            # –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
            network_configs = self._prepare_network_configs(networks, bridge_mapping, device_type)

            # –ü–∞–∫–µ—Ç–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
            return self.proxmox.configure_vm_network(vmid, node, network_configs)

        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏ –¥–ª—è VM {vmid}: {e}")
            return False

    def allocate_bridge(self, node: str, bridge_name: str, pool: str,
                       reserved: bool = False) -> str:
        """–í—ã–¥–µ–ª–∏—Ç—å bridge –¥–ª—è —Å–µ—Ç–∏"""
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö bridge'–µ–π
        if reserved or bridge_name.startswith('**'):
            return bridge_name.strip('*')

        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–º–µ–Ω–∏ bridge'–∞
        cache_key = f"{node}:{pool}:{bridge_name}"
        if cache_key in self.bridge_cache:
            return self.bridge_cache[cache_key]

        # –ù–∞–π—Ç–∏ —Å–ª–µ–¥—É—é—â–µ–µ –¥–æ—Å—Ç—É–ø–Ω–æ–µ –∏–º—è
        base_name = bridge_name or "vmbr"
        bridge = self._find_next_available_bridge(node, base_name)

        # –°–æ–∑–¥–∞—Ç—å bridge –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        if not self.proxmox.bridge_exists(node, bridge):
            self.proxmox.create_bridge(node, bridge)

        # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∫–µ—à
        self.bridge_cache[cache_key] = bridge
        return bridge

    def cleanup_unused_bridges(self, nodes: List[str]) -> int:
        """–û—á–∏—Å—Ç–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ bridge'—ã"""
        cleaned_count = 0

        for node in nodes:
            # –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ bridge'—ã –Ω–∞ –Ω–æ–¥–µ
            all_bridges = self.proxmox.list_bridges(node)

            for bridge in all_bridges:
                # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ bridge'—ã
                if bridge in ['vmbr0']:
                    continue

                # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ bridge'–∞
                if not self.proxmox.bridge_in_use(node, bridge):
                    # –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π bridge
                    if self.proxmox.delete_bridge(node, bridge):
                        cleaned_count += 1

        return cleaned_count
```

## –§–ê–ë–†–ò–ö–ê –ú–û–î–£–õ–ï–ô

### –ú–æ–¥—É–ª—å–Ω–∞—è —Ñ–∞–±—Ä–∏–∫–∞ (core/module_factory.py)
```python
from typing import Dict, Any, Type
from core.interfaces.deployment_interface import DeploymentInterface
from core.interfaces.balancing_interface import BalancingInterface
from core.interfaces.template_interface import TemplateInterface
from core.interfaces.network_interface import NetworkInterface

class ModuleFactory:
    """–§–∞–±—Ä–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–¥—É–ª—è–º–∏"""

    def __init__(self):
        self.modules = {}
        self.interfaces = {}

    def register_deployment_module(self, name: str, module_class: Type[DeploymentInterface]):
        """–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è"""
        self.modules[f"deployment:{name}"] = module_class

    def register_balancing_module(self, name: str, module_class: Type[BalancingInterface]):
        """–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏"""
        self.modules[f"balancing:{name}"] = module_class

    def register_template_module(self, name: str, module_class: Type[TemplateInterface]):
        """–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å —à–∞–±–ª–æ–Ω–æ–≤"""
        self.modules[f"template:{name}"] = module_class

    def register_network_module(self, name: str, module_class: Type[NetworkInterface]):
        """–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç–µ–≤–æ–π –º–æ–¥—É–ª—å"""
        self.modules[f"network:{name}"] = module_class

    def create_deployment_module(self, name: str, **kwargs) -> DeploymentInterface:
        """–°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è"""
        module_class = self.modules.get(f"deployment:{name}")
        if not module_class:
            raise ValueError(f"–ú–æ–¥—É–ª—å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è '{name}' –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return module_class(**kwargs)

    def create_balancing_module(self, name: str, **kwargs) -> BalancingInterface:
        """–°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏"""
        module_class = self.modules.get(f"balancing:{name}")
        if not module_class:
            raise ValueError(f"–ú–æ–¥—É–ª—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ '{name}' –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return module_class(**kwargs)

    def create_template_module(self, name: str, **kwargs) -> TemplateInterface:
        """–°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å —à–∞–±–ª–æ–Ω–æ–≤"""
        module_class = self.modules.get(f"template:{name}")
        if not module_class:
            raise ValueError(f"–ú–æ–¥—É–ª—å —à–∞–±–ª–æ–Ω–æ–≤ '{name}' –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return module_class(**kwargs)

    def create_network_module(self, name: str, **kwargs) -> NetworkInterface:
        """–°–æ–∑–¥–∞—Ç—å —Å–µ—Ç–µ–≤–æ–π –º–æ–¥—É–ª—å"""
        module_class = self.modules.get(f"network:{name}")
        if not module_class:
            raise ValueError(f"–°–µ—Ç–µ–≤–æ–π –º–æ–¥—É–ª—å '{name}' –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return module_class(**kwargs)

    def list_available_modules(self, module_type: str = None) -> List[str]:
        """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥—É–ª–µ–π"""
        if module_type:
            return [name.split(':')[1] for name in self.modules.keys() if name.startswith(f"{module_type}:")]
        return list(self.modules.keys())
```

## –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ú–û–î–£–õ–ï–ô

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –º–æ–¥—É–ª–µ–π (core/module_config.yml)
```yaml
# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π —Å–∏—Å—Ç–µ–º—ã
modules:
  deployment:
    default: "basic"              # –ú–æ–¥—É–ª—å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    available:
      - "basic"                   # –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞—Ç–µ–ª—å
      - "advanced"                # –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞—Ç–µ–ª—å

  balancing:
    default: "smart"              # –ú–æ–¥—É–ª—å –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    available:
      - "simple"                  # –ü—Ä–æ—Å—Ç–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞
      - "smart"                   # –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞

  templates:
    default: "local"              # –ú–æ–¥—É–ª—å —à–∞–±–ª–æ–Ω–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    available:
      - "local"                   # –õ–æ–∫–∞–ª—å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã
      - "migration"               # –ú–∏–≥—Ä–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–æ–≤

  network:
    default: "bridge"             # –°–µ—Ç–µ–≤–æ–π –º–æ–¥—É–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    available:
      - "bridge"                  # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ bridge'–∞–º–∏

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥—É–ª–µ–π
module_parameters:
  balancing:
    smart:
      cache_ttl: 300              # –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –∫–µ—à–∞ (—Å–µ–∫—É–Ω–¥—ã)
      optimization_threshold: 0.7 # –ü–æ—Ä–æ–≥ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

  templates:
    local:
      migration_timeout: 1800     # –¢–∞–π–º–∞—É—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ (—Å–µ–∫—É–Ω–¥—ã)
      retry_attempts: 3           # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫

  network:
    bridge:
      bridge_start_number: 1000   # –ù–∞—á–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö bridge'–µ–π
      cleanup_interval: 3600      # –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—á–∏—Å—Ç–∫–∏ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö bridge'–µ–π
```

## –ü–†–ò–ú–ï–† –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø –ú–û–î–£–õ–¨–ù–û–ô –ê–†–•–ò–¢–ï–ö–¢–£–†–´

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —Å –º–æ–¥—É–ª—è–º–∏ (main.py)
```python
from core.module_factory import ModuleFactory
from core.proxmox.proxmox_client import ProxmoxClient
from core.config.config_manager import ConfigManager
from utils.logging.logger import Logger
from utils.caching.cache_manager import CacheManager
from utils.monitoring.metrics import PerformanceMetrics

def main():
    """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã"""
    try:
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
        logger = Logger()
        cache = CacheManager()
        metrics = PerformanceMetrics()
        config_manager = ConfigManager()

        # –°–æ–∑–¥–∞—Ç—å —Ñ–∞–±—Ä–∏–∫—É –º–æ–¥—É–ª–µ–π
        module_factory = ModuleFactory()

        # –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥—É–ª–∏
        register_modules(module_factory)

        # –°–æ–∑–¥–∞—Ç—å Proxmox –∫–ª–∏–µ–Ω—Ç
        proxmox_config = config_manager.load_proxmox_config()
        proxmox_client = ProxmoxClient(proxmox_config)

        # –°–æ–∑–¥–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–æ–¥—É–ª–∏
        deployment_module = module_factory.create_deployment_module(
            "advanced",
            proxmox_client=proxmox_client,
            config_manager=config_manager,
            cache=cache,
            metrics=metrics
        )

        balancing_module = module_factory.create_balancing_module(
            "smart",
            proxmox_client=proxmox_client,
            cache=cache,
            metrics=metrics
        )

        template_module = module_factory.create_template_module(
            "local",
            proxmox_client=proxmox_client,
            cache=cache
        )

        network_module = module_factory.create_network_module(
            "bridge",
            proxmox_client=proxmox_client
        )

        # –°–æ–∑–¥–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å –º–æ–¥—É–ª—è–º–∏
        menu = MainMenu(deployment_module, balancing_module, template_module, network_module)
        menu.show()

    except Exception as e:
        logger.critical(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: {e}")
        sys.exit(1)

def register_modules(factory: ModuleFactory):
    """–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥—É–ª–µ–π"""
    # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
    factory.register_deployment_module("basic", BasicDeployer)
    factory.register_deployment_module("advanced", AdvancedDeployer)

    # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏
    factory.register_balancing_module("simple", SimpleBalancer)
    factory.register_balancing_module("smart", SmartBalancer)

    # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π —à–∞–±–ª–æ–Ω–æ–≤
    factory.register_template_module("local", LocalTemplateManager)
    factory.register_template_module("migration", MigrationTemplateManager)

    # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ç–µ–≤—ã—Ö –º–æ–¥—É–ª–µ–π
    factory.register_network_module("bridge", BridgeManager)
```

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Å–º–µ–Ω–∞ –º–æ–¥—É–ª–µ–π –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```python
class MainMenu:
    def __init__(self, deployment_module, balancing_module, template_module, network_module):
        self.deployment_module = deployment_module
        self.balancing_module = balancing_module
        self.template_module = template_module
        self.network_module = network_module
        self.module_factory = ModuleFactory()

    def change_deployment_strategy(self, strategy_name: str):
        """–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–º–µ–Ω–∏—Ç—å –º–æ–¥—É–ª—å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è"""
        try:
            new_module = self.module_factory.create_deployment_module(
                strategy_name,
                proxmox_client=self.proxmox_client,
                config_manager=self.config_manager,
                cache=self.cache,
                metrics=self.metrics
            )
            self.deployment_module = new_module
            logger.info(f"–ú–æ–¥—É–ª—å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω –Ω–∞: {strategy_name}")
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ —Å–º–µ–Ω—ã –º–æ–¥—É–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è: {e}")

    def get_available_strategies(self) -> List[str]:
        """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è"""
        return self.module_factory.list_available_modules("deployment")
```

## –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –ú–û–î–£–õ–¨–ù–û–ô –ê–†–•–ò–¢–ï–ö–¢–£–†–´

### 1. –ò–∑–æ–ª—è—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –∏–º–µ–µ—Ç —á–µ—Ç–∫—É—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
- –õ–µ–≥–∫–æ—Å—Ç—å –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è –∫–æ–¥–∞
- –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤

### 2. –õ–µ–≥–∫–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ö–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- Mock –æ–±—ä–µ–∫—Ç—ã –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –º–æ–¥—É–ª–µ–π
- Unit —Ç–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ

### 3. –ì–∏–±–∫–æ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –õ–µ–≥–∫–∞—è —Å–º–µ–Ω–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ YAML —Ñ–∞–π–ª—ã
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π –±–µ–∑ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö

### 4. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Ä–∞–º–∫–∞—Ö –º–æ–¥—É–ª–µ–π
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞—á
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –≤–Ω—É—Ç—Ä–∏ –º–æ–¥—É–ª–µ–π

### 5. –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–Ω—É—Ç—Ä–∏ –º–æ–¥—É–ª–µ–π
- Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ø—Ä–∏ —Å–±–æ—è—Ö –º–æ–¥—É–ª–µ–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è

–≠—Ç–æ—Ç –º–æ–¥—É–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –≥–∏–±–∫–æ—Å—Ç—å –∏ —É–¥–æ–±—Å—Ç–≤–æ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã Deploy-Stand.

#### 1. –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (main.py)
```python
# –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:
def main():
    # - –°–æ–∑–¥–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é
    # - –ó–∞–ø—É—Å—Ç–∏—Ç—å –≥–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    # - –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    # - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
```

#### 2. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (app/ui/cli_menus.py)
```python
class MainMenu:
    def __init__(self):
        # - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä—ã: config, proxmox, vm_deployer, user_manager
        # - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Proxmox

    def show(self):
        """–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å –±—ã—Å—Ç—Ä—ã–º –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ñ—É–Ω–∫—Ü–∏—è–º"""
        # –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º
        quick_actions = {
            'd': '4',  # d = deploy (—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å)
            'c': '1',  # c = create config (—Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é)
            'u': '3',  # u = users (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
            'x': '5',  # x = cleanup (–æ—á–∏—Å—Ç–∫–∞)
        }

        while True:
            # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ–Ω—é —Å –≥–æ—Ä—è—á–∏–º–∏ –∫–ª–∞–≤–∏—à–∞–º–∏
            print("\nüöÄ Deploy-Stand - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é")
            print("=" * 50)
            print("üìã –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:")
            print("  [1] –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è")
            print("  [2] –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏")
            print("  [3] –£–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π")
            print("  [4] üöÄ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é")
            print("  [5] üóëÔ∏è  –£–¥–∞–ª–∏—Ç—å –º–∞—à–∏–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π")
            print("  [6] –£–¥–∞–ª–∏—Ç—å –º–∞—à–∏–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è")
            print("  [7] ‚öôÔ∏è  –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º")
            print("  [0] –í—ã—Ö–æ–¥")
            print("\n‚ö° –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã:")
            print("  d = –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å | c = –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ | u = –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | x = –û—á–∏—Å—Ç–∫–∞")

            # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–≤–æ–¥ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –±—ã—Å—Ç—Ä—ã—Ö –∫–æ–º–∞–Ω–¥
            choice = input("\n–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ: ").strip().lower()

            # –û–±—Ä–∞–±–æ—Ç–∫–∞ –±—ã—Å—Ç—Ä—ã—Ö –∫–æ–º–∞–Ω–¥
            if choice in quick_actions:
                choice = quick_actions[choice]

            # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π
            action_result = self._handle_menu_choice(choice)
            if action_result == "exit":
                break
            elif action_result == "repeat":
                continue

    def _handle_menu_choice(self, choice: str) -> str:
        """–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ –º–µ–Ω—é —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π"""
        menu_actions = {
            "1": lambda: self._create_deployment_config(),
            "2": lambda: self._manage_configs_menu(),
            "3": lambda: self._manage_users_menu(),
            "4": lambda: self._deploy_menu(),
            "5": lambda: self._delete_all_users_resources(),
            "6": lambda: self._delete_single_user_resources(),
            "7": lambda: self._manage_connection_config_menu(),
            "0": lambda: "exit"
        }

        action = menu_actions.get(choice)
        if action:
            try:
                return action() if callable(action) else action
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è {choice}: {e}")
                print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
                return "repeat"
        else:
            print("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ü–∏—Ñ—Ä—ã 0-7 –∏–ª–∏ –±—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã (d, c, u, x)")
            return "repeat"

    def _setup_proxmox_connection(self):
        """–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å –∞–≤—Ç–æ–¥–µ—Ç–µ–∫—Ç–æ–º"""
        # –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        # –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
        # –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (host, user, password/token)
        # –°–æ–∑–¥–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Proxmox API
        # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

    def _create_deployment_config(self):
        """–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º"""
        print("\nüöÄ –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è")
        print("=" * 50)

        # –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
        print("–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã:")
        print("  [1] –°—Ç—É–¥–µ–Ω—á–µ—Å–∫–∏–π —Å—Ç–µ–Ω–¥ (Linux VM + —Å–µ—Ç—å)")
        print("  [2] –°–µ—Ç–µ–≤–æ–π —Å—Ç–µ–Ω–¥ (Router + –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ç–µ–π)")
        print("  [3] –ö–∞—Å—Ç–æ–º–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è")
        print("  [0] –ù–∞–∑–∞–¥")

        template_choice = input("–í—ã–±–µ—Ä–∏—Ç–µ —à–∞–±–ª–æ–Ω (1-3) –∏–ª–∏ 0 –¥–ª—è –Ω–∞–∑–∞–¥: ").strip()

        if template_choice == "0":
            return "repeat"
        elif template_choice in ["1", "2"]:
            # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã
            return self._create_config_from_template(template_choice)
        elif template_choice == "3":
            # –ö–∞—Å—Ç–æ–º–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
            return self._create_custom_config()
        else:
            print("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä!")
            return "repeat"

    def _deploy_menu(self):
        """–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –º–µ–Ω—é —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏"""
        print("\nüöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏")
        print("=" * 50)

        # –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        configs = self.config_manager.list_configs()
        if not configs:
            print("‚ùå –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π!")
            print("üí° –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ –º–µ–Ω—é 1 –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ deployment_config.yml")
            return "repeat"

        print("–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:")
        for i, config_name in enumerate(configs, 1):
            print(f"  [{i}] {config_name}")

        print("\n–ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä:")
        print("  [default] - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å deployment_config.yml")
        print("  [last] - –ø–æ—Å–ª–µ–¥–Ω—è—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è")
        print("  [–Ω–æ–º–µ—Ä] - –≤—ã–±—Ä–∞—Ç—å –ø–æ –Ω–æ–º–µ—Ä—É")

        choice = input("\n–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é: ").strip().lower()

        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –±—ã—Å—Ç—Ä—ã—Ö –≤—ã–±–æ—Ä–æ–≤
        if choice == "default":
            config = self.config_manager.load_deployment_config()
            config_name = "deployment_config.yml"
        elif choice == "last":
            # –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
            config = self._load_last_used_config()
            config_name = "–ø–æ—Å–ª–µ–¥–Ω—è—è"
        else:
            try:
                config_index = int(choice) - 1
                if 0 <= config_index < len(configs):
                    config = self.config_manager.load_config(configs[config_index])
                    config_name = configs[config_index]
                else:
                    print(f"‚ùå –í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –æ—Ç 1 –¥–æ {len(configs)}")
                    return "repeat"
            except ValueError:
                print("‚ùå –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –∏–ª–∏ 'default'/'last'")
                return "repeat"

        if not config:
            print("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏!")
            return "repeat"

        # –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
        print("\n–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:")
        print("  [1] üöÄ –ë—ã—Å—Ç—Ä–æ–µ (–æ–¥–Ω–∞ –Ω–æ–¥–∞) - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∞")
        print("  [2] ‚öñÔ∏è  –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ (–≤—Å–µ –Ω–æ–¥—ã) - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production")
        print("  [3] üéØ –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –Ω–æ–¥–∞")

        strategy_choice = input("–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é (1-3) [1]: ").strip() or "1"

        if strategy_choice == "1":
            node_selection = "auto"
            target_node = None
        elif strategy_choice == "2":
            node_selection = "balanced"
            target_node = None
        elif strategy_choice == "3":
            node_selection = "specific"
            nodes = self.proxmox_manager.get_nodes()
            print(f"–î–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–æ–¥—ã: {', '.join(nodes)}")
            target_node = input("–í–≤–µ–¥–∏—Ç–µ –∏–º—è —Ü–µ–ª–µ–≤–æ–π –Ω–æ–¥—ã: ").strip()
        else:
            print("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏!")
            return "repeat"

        # –ó–∞–ø—É—Å–∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º
        print(f"\nüöÄ –ù–∞—á–∏–Ω–∞–µ–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ '{config_name}'...")
        print("–°—Ç—Ä–∞—Ç–µ–≥–∏—è:", "–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞" if node_selection == "balanced" else "–æ–¥–∏–Ω–æ—á–Ω–∞—è –Ω–æ–¥–∞")

        try:
            results = self.vm_deployer.deploy_configuration(
                self.config_manager.load_users(),
                config,
                node_selection,
                target_node
            )

            # –ö—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            print(f"\n‚úÖ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
            print(f"–°–æ–∑–¥–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {len(results)}")

            if results:
                print("\nüìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:")
                print("-" * 60)
                print(f"{'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å'"<20"} {'–ü–∞—Ä–æ–ª—å'"<20"}")
                print("-" * 60)
                for user, password in results.items():
                    print(f"{user"<20"} {password"<20"}")
            else:
                print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –Ω–∏ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è")

        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è: {e}")

        input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...")
        return "repeat"

    def _manage_users_menu(self):
        """–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏"""
        print("\nüë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏")
        print("=" * 50)

        print("–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:")
        print("  [1] –í–≤–µ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤—Ä—É—á–Ω—É—é")
        print("  [2] –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ —Ñ–∞–π–ª–∞")
        print("  [3] –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–π —Å–ø–∏—Å–æ–∫")
        print("  [4] –û—á–∏—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫")
        print("  [0] –ù–∞–∑–∞–¥")

        choice = input("–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ: ").strip()

        if choice == "1":
            users_input = input("–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (user1@pve,user2@pve): ")
            users = [user.strip() for user in users_input.split(',') if user.strip()]
            if self.config_manager.save_users(users):
                print(f"‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ {len(users)} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π")
            else:
                print("‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è")
        elif choice == "2":
            file_path = input("–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å–æ —Å–ø–∏—Å–∫–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ").strip()
            if self.config_manager.save_users_from_file(file_path):
                print("‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ —Ñ–∞–π–ª–∞")
            else:
                print("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞")
        elif choice == "3":
            users = self.config_manager.load_users()
            if users:
                print(f"\n–¢–µ–∫—É—â–∏–π —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ({len(users)}):")
                for i, user in enumerate(users, 1):
                    print(f"  {i}. {user}")
            else:
                print("‚ùå –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—É—Å—Ç")
        elif choice == "4":
            confirm = input("–û—á–∏—Å—Ç–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π? (y/n): ")
            if confirm.lower() == 'y':
                if self.config_manager.save_users([]):
                    print("‚úÖ –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—á–∏—â–µ–Ω")
                else:
                    print("‚ùå –û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏")
        elif choice == "0":
            return "repeat"
        else:
            print("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä!")

        input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...")
        return "repeat"

    def _delete_all_users_resources(self):
        """–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–∞–∫–µ—Ç–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º"""
        users = self.config_manager.load_users()

        if not users:
            print("‚ùå –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—É—Å—Ç!")
            return "repeat"

        print(f"\nüóëÔ∏è  –ü–∞–∫–µ—Ç–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤")
        print("=" * 50)
        print(f"–ù–∞–π–¥–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {len(users)}")
        print("–ë—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã:")
        print("  ‚Ä¢ –í—Å–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π")
        print("  ‚Ä¢ –ü—É–ª—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π")
        print("  ‚Ä¢ –£—á–µ—Ç–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π")
        print("  ‚Ä¢ –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–µ—Ç–µ–≤—ã–µ bridge'—ã")

        # –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        confirm = input("\n–í—ã —É–≤–µ—Ä–µ–Ω—ã? –í–≤–µ–¥–∏—Ç–µ 'DELETE_ALL' –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: ").strip()

        if confirm == "DELETE_ALL":
            print("üóëÔ∏è  –ù–∞—á–∏–Ω–∞–µ–º —É–¥–∞–ª–µ–Ω–∏–µ...")
            results = self.user_manager.delete_user_resources_batch(users)

            print("
üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —É–¥–∞–ª–µ–Ω–∏—è:"            print(f"  ‚úÖ –£—Å–ø–µ—à–Ω–æ: {len(results['successful'])}")
            print(f"  ‚ùå –û—à–∏–±–æ–∫: {len(results['failed'])}")
            print(f"  ‚è≠Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω–æ: {len(results['skipped'])}")

            if results['failed']:
                print(f"\n‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å: {', '.join(results['failed'])}")
        else:
            print("‚ùå –û–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞")

        input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...")
        return "repeat"

    def _manage_configs_menu(self):
        """–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏"""
        print("\n‚öôÔ∏è  –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏")
        print("=" * 50)

        configs = self.config_manager.list_configs()

        if configs:
            print(f"–ù–∞–π–¥–µ–Ω–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π: {len(configs)}")
            for i, config_name in enumerate(configs, 1):
                print(f"  [{i}] {config_name}")

            print("\n–î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:")
            print("  [1] –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é")
            print("  [2] –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏")
            print("  [3] –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é")
            print("  [4] –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é")
            print("  [0] –ù–∞–∑–∞–¥")

            choice = input("–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ: ").strip()

            if choice == "1":
                config_name = input("–ò–º—è –Ω–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: ").strip()
                if config_name:
                    nodes = self.proxmox_manager.get_nodes()
                    self.config_manager.create_named_config(config_name, nodes, self.proxmox_manager)
                else:
                    print("‚ùå –ò–º—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º!")
            elif choice == "2":
                # –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
                self._show_config_details(configs)
            elif choice == "3":
                # –£–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
                self._delete_config_interactive(configs)
            elif choice == "4":
                # –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
                self._copy_config_interactive(configs)
            else:
                print("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä!")
        else:
            print("‚ùå –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!")
            print("üí° –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ –º–µ–Ω—é 1")

        input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...")
        return "repeat"

    def _show_config_details(self, configs):
        """–ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"""
        try:
            config_num = int(input("–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: ")) - 1
            if 0 <= config_num < len(configs):
                config = self.config_manager.load_config(configs[config_num])
                if config:
                    print(f"\n–î–µ—Ç–∞–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ '{configs[config_num]}':")
                    print(f"  –ú–∞—à–∏–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: {len(config.get('machines', []))}")
                    for i, machine in enumerate(config.get('machines', []), 1):
                        print(f"\n  –ú–∞—à–∏–Ω–∞ {i}:")
                        print(f"    –¢–∏–ø: {machine.get('device_type', 'linux')}")
                        print(f"    –ò–º—è: {machine.get('name', '–Ω–µ —É–∫–∞–∑–∞–Ω–æ')}")
                        print(f"    –®–∞–±–ª–æ–Ω: VMID {machine.get('template_vmid')} –Ω–∞ –Ω–æ–¥–µ {machine.get('template_node')}")
                        print(f"    –°–µ—Ç–µ–π: {len(machine.get('networks', []))}")
                        print(f"    –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ: {'–ø–æ–ª–Ω–æ–µ' if machine.get('full_clone') else '—Å–≤—è–∑–∞–Ω–Ω–æ–µ'}")
                else:
                    print("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏")
            else:
                print(f"‚ùå –í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –æ—Ç 1 –¥–æ {len(configs)}")
        except ValueError:
            print("‚ùå –í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä")

    def _delete_config_interactive(self, configs):
        """–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"""
        try:
            config_num = int(input("–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è: ")) - 1
            if 0 <= config_num < len(configs):
                config_name = configs[config_num]
                confirm = input(f"–£–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é '{config_name}'? (y/n): ")
                if confirm.lower() == 'y':
                    self.config_manager.delete_config(config_name)
                    print(f"‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è '{config_name}' —É–¥–∞–ª–µ–Ω–∞")
                else:
                    print("‚ùå –û–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞")
            else:
                print(f"‚ùå –í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –æ—Ç 1 –¥–æ {len(configs)}")
        except ValueError:
            print("‚ùå –í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä")

    def _copy_config_interactive(self, configs):
        """–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"""
        try:
            source_num = int(input("–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ")) - 1
            if 0 <= source_num < len(configs):
                new_name = input("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –¥–ª—è –∫–æ–ø–∏–∏: ").strip()
                if new_name:
                    # –õ–æ–≥–∏–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
                    print(f"‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è '{configs[source_num]}' —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –∫–∞–∫ '{new_name}'")
                else:
                    print("‚ùå –ò–º—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º!")
            else:
                print(f"‚ùå –í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –æ—Ç 1 –¥–æ {len(configs)}")
        except ValueError:
            print("‚ùå –í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä")

    def _load_last_used_config(self):
        """–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é"""
        # –õ–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
        return self.config_manager.load_deployment_config()

    def _create_config_from_template(self, template_type):
        """–°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏–∑ —à–∞–±–ª–æ–Ω–∞"""
        print(f"\nüìã –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ —à–∞–±–ª–æ–Ω–∞ {template_type}")
        print("=" * 50)

        if template_type == "1":
            # –®–∞–±–ª–æ–Ω —Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ —Å—Ç–µ–Ω–¥–∞
            config_name = input("–ò–º—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ [student-lab]: ").strip() or "student-lab"
            num_students = input("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ [10]: ").strip() or "10"

            print("‚úÖ –°–æ–∑–¥–∞–Ω —à–∞–±–ª–æ–Ω —Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–æ–≥–æ —Å—Ç–µ–Ω–¥–∞")
            print(f"   –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: {config_name}")
            print(f"   –°—Ç—É–¥–µ–Ω—Ç–æ–≤: {num_students}")
            print("   –í–∫–ª—é—á–∞–µ—Ç: Linux VM, —Å–µ—Ç—å, –±–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏")

        elif template_type == "2":
            # –®–∞–±–ª–æ–Ω —Å–µ—Ç–µ–≤–æ–≥–æ —Å—Ç–µ–Ω–¥–∞
            config_name = input("–ò–º—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ [router-lab]: ").strip() or "router-lab"
            num_routers = input("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–æ—É—Ç–µ—Ä–æ–≤ [3]: ").strip() or "3"

            print("‚úÖ –°–æ–∑–¥–∞–Ω —à–∞–±–ª–æ–Ω —Å–µ—Ç–µ–≤–æ–≥–æ —Å—Ç–µ–Ω–¥–∞")
            print(f"   –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: {config_name}")
            print(f"   –†–æ—É—Ç–µ—Ä–æ–≤: {num_routers}")
            print("   –í–∫–ª—é—á–∞–µ—Ç: Ecorouter —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ—Ç–µ–π")

        input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...")
        return "repeat"

    def _create_custom_config(self):
        """–°–æ–∑–¥–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é"""
        print("\nüîß –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏")
        print("=" * 50)
        print("üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—é 1 –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Å—Ç–æ–º–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏")
        input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...")
        return "repeat"
```

#### 3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ Proxmox (app/core/proxmox_manager.py)
```python
class ProxmoxManager:
    def __init__(self):
        # - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Proxmox API

    def connect(self, host, user, password=None, token_name=None, token_value=None):
        # - –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:
        #   * –ü–æ –ø–∞—Ä–æ–ª—é (password)
        #   * –ü–æ —Ç–æ–∫–µ–Ω—É (token_name + token_value)
        # - –°–æ–∑–¥–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ proxmoxer.ProxmoxAPI
        # - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤—ã–∑–æ–≤–æ–º API
        # - –í–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ç—É—Å —É—Å–ø–µ—Ö–∞/–æ—à–∏–±–∫–∏

    def get_nodes(self):
        # - –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –Ω–æ–¥ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ
        # - –í–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ –∏–º–µ–Ω –Ω–æ–¥

    def get_next_vmid(self):
        # - –ü–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π VMID –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞
        # - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å cluster.nextid API

    def clone_vm(self, template_node, template_vmid, target_node, new_vmid, name, pool, full_clone=False):
        # - –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É
        # - –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å linked –∏ full clone
        # - –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –Ω–æ–¥–∞–º–∏

    def ensure_bridge(self, node, bridge_name):
        # - –°–æ–∑–¥–∞—Ç—å —Å–µ—Ç–µ–≤–æ–π bridge –µ—Å–ª–∏ –æ–Ω –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        # - –û–±–Ω–æ–≤–∏—Ç—å —Å–µ—Ç–µ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –Ω–æ–¥—ã

    def delete_vm(self, node, vmid):
        # - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É
        # - –£–¥–∞–ª–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É
        # - –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏
```

#### 4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏ (app/core/config.py)
```python
class ConfigManager:
    # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è –ø—É—Ç–µ–π –∫ —Ñ–∞–π–ª–∞–º
    CONFIG_DIR = "data"
    CONFIG_FILE = "data/deployment_config.yml"
    USERS_FILE = "data/users_list.yml"
    CONFIGS_DIR = "data/configs"
    CONNECTIONS_FILE = "data/connections_config.yml"

    @staticmethod
    def create_deployment_config(nodes, proxmox_manager):
        # - –ó–∞–ø—Ä–æ—Å–∏—Ç—å —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
        #   * –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        #   * –î–ª—è –∫–∞–∂–¥–æ–π –º–∞—à–∏–Ω—ã:
        #     - –¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (linux/ecorouter)
        #     - –ò–º—è –º–∞—à–∏–Ω—ã
        #     - –ù–æ–¥–∞ —à–∞–±–ª–æ–Ω–∞
        #     - VMID —à–∞–±–ª–æ–Ω–∞
        #     - –°–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (bridge'—ã)
        #     - –¢–∏–ø –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (linked/full)
        # - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤ YAML —Ñ–∞–π–ª

    @staticmethod
    def load_deployment_config():
        # - –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏–∑ YAML —Ñ–∞–π–ª–∞
        # - –í–µ—Ä–Ω—É—Ç—å —Å–ª–æ–≤–∞—Ä—å —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

    @staticmethod
    def save_users(users_list):
        # - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ YAML —Ñ–∞–π–ª
        # - –§–æ—Ä–º–∞—Ç: users: [user1@pve, user2@pve, ...]

    @staticmethod
    def load_users():
        # - –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ YAML —Ñ–∞–π–ª–∞
        # - –í–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```

#### 5. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (app/core/user_manager.py)
```python
class UserManager:
    def __init__(self, proxmox_manager):
        # - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ proxmox_manager

    def create_user_and_pool(self, username):
        # - –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Proxmox
        # - –°–æ–∑–¥–∞—Ç—å –ø—É–ª –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        # - –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π –ø–∞—Ä–æ–ª—å
        # - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫ –ø—É–ª—É
        # - –í–µ—Ä–Ω—É—Ç—å (success, password)

    def delete_user_resources_batch(self, users):
        # - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
        #   * –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –µ–≥–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã
        #   * –£–¥–∞–ª–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã
        #   * –£–¥–∞–ª–∏—Ç—å –ø—É–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        #   * –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        # - –í–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–π
```

#### 6. –õ–æ–≥–∏–∫–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (app/core/vm_deployer.py)
```python
class VMDeployer:
    def __init__(self, proxmox_manager):
        # - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä—ã:
        #   * user_manager
        #   * template_manager
        #   * vm_operations
        #   * deployment_distributor

    def deploy_configuration(self, users, config, node_selection="auto", target_node=None):
        # - –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —à–∞–±–ª–æ–Ω—ã –¥–ª—è —Ü–µ–ª–µ–≤—ã—Ö –Ω–æ–¥
        # - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
        # - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
        #   * –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø—É–ª
        #   * –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã —Å–æ–≥–ª–∞—Å–Ω–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
        #   * –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
        # - –í–µ—Ä–Ω—É—Ç—å —Å–ª–æ–≤–∞—Ä—å {user: password}

    def _prepare_templates_for_target_node(self, config, node_selection, target_node):
        # - –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–∫–∏–µ —à–∞–±–ª–æ–Ω—ã –Ω—É–∂–Ω—ã –Ω–∞ –∫–∞–∫–∏—Ö –Ω–æ–¥–∞—Ö
        # - –°–æ–∑–¥–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã —á–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏—é –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
        # - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å mapping —à–∞–±–ª–æ–Ω–æ–≤
```

#### 7. –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–≥—Ä—É–∑–∫–∏ (app/core/balanced_deployer.py)
```python
class BalancedDeployer:
    def __init__(self, proxmox_manager, vm_deployer):
        # - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ –º–µ–Ω–µ–¥–∂–µ—Ä—ã

    def deploy_balanced(self, users, config):
        # - –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –Ω–æ–¥
        # - –†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –Ω–æ–¥–∞–º —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ
        # - –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å —É—á–µ—Ç–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
        # - –í–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
```

#### 8. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞–º–∏ (app/core/template_manager.py)
```python
class TemplateManager:
    def __init__(self, proxmox_manager):
        # - –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ mapping —à–∞–±–ª–æ–Ω–æ–≤

    def prepare_templates_for_target_node(self, config, node_selection, target_node):
        # - –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–∫–∏–µ —à–∞–±–ª–æ–Ω—ã –Ω—É–∂–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ
        # - –°–æ–∑–¥–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã —á–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏—é
        # - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —à–∞–±–ª–æ–Ω–∞—Ö

    def save_template_mapping(self):
        # - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å mapping –ª–æ–∫–∞–ª—å–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤ –≤ YAML —Ñ–∞–π–ª
```

#### 9. –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º–∏ –º–∞—à–∏–Ω–∞–º–∏ (app/core/vm_operations.py)
```python
class VMOperations:
    def __init__(self, proxmox_manager):
        # - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ proxmox_manager

    def create_user_vms(self, config, target_node, pool):
        # - –î–ª—è –∫–∞–∂–¥–æ–π –º–∞—à–∏–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
        #   * –ü–æ–ª—É—á–∏—Ç—å –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —à–∞–±–ª–æ–Ω
        #   * –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É
        #   * –î–æ–±–∞–≤–∏—Ç—å –≤ –ø—É–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        #   * –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

    def check_existing_vms_in_pools(self, users, config):
        # - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–µ—Ç –ª–∏ —É–∂–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω –≤ –ø—É–ª–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        # - –í–µ—Ä–Ω—É—Ç—å True –µ—Å–ª–∏ –º–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
```

#### 10. –†–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å —Ä–µ—Å—É—Ä—Å–æ–≤ (app/core/deployment_distributor.py)
```python
class DeploymentDistributor:
    def __init__(self, proxmox_manager):
        # - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ proxmox_manager

    def distribute_deployment(self, users, nodes):
        # - –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –Ω–∞–≥—Ä—É–∑–∫—É –Ω–æ–¥
        # - –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        # - –í–µ—Ä–Ω—É—Ç—å —Å–ª–æ–≤–∞—Ä—å {node: [users]}
```

## –ö–õ–Æ–ß–ï–í–´–ï –ê–õ–ì–û–†–ò–¢–ú–´ –î–õ–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### –ê–ª–≥–æ—Ä–∏—Ç–º 1: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —à–∞–±–ª–æ–Ω–∞ —á–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏—é
```python
def create_local_template_via_migration(template_node, template_vmid, target_node, new_vmid, name, pool):
    """
    –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º —Å–æ–∑–¥–∞–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —à–∞–±–ª–æ–Ω–∞:
    - –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
    - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á
    - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –æ—Ç–∫–∞—Ç–æ–º
    - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    """

    # 1. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
    if not check_node_resources(template_node, target_node):
        return False

    # 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —à–∞–±–ª–æ–Ω–∞ –≤ –∫–µ—à–µ
    cache_key = f"{template_vmid}:{target_node}"
    if check_template_cache(cache_key, new_vmid):
        return True

    # 3. –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω—ã–π –∫–ª–æ–Ω –Ω–∞ –∏—Å—Ö–æ–¥–Ω–æ–π –Ω–æ–¥–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
    clone_task = proxmox.nodes(template_node).qemu(template_vmid).clone.post(
        newid=new_vmid,
        name=f"temp-{template_vmid}-{target_node}",
        target=template_node,
        full=1
    )

    # 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–¥–∞—á—É –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ —à–∞–±–ª–æ–Ω –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
    template_task = None
    if wait_for_task(clone_task, template_node, timeout=600):
        template_task = proxmox.nodes(template_node).qemu(new_vmid).template.post()

    # 5. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–µ–¥–ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–µ—Ç–∏
    if template_node != target_node:
        if not check_migration_path(template_node, target_node):
            # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: —Å–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –Ω–æ–¥–µ
            return create_template_locally(target_node, template_vmid, new_vmid)

        migration_task = proxmox.nodes(template_node).qemu(new_vmid).migrate.post(
            target=target_node,
            online=1,
            timeout=1800
        )

        if not wait_for_task(migration_task, template_node):
            # –û—Ç–∫–∞—Ç: —É–¥–∞–ª–∏—Ç—å –Ω–µ—É–¥–∞—á–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —à–∞–±–ª–æ–Ω
            cleanup_failed_template(template_node, new_vmid)
            return False

    # 6. –ö–µ—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    update_template_cache(cache_key, new_vmid, target_node)
    return True
```

### –ê–ª–≥–æ—Ä–∏—Ç–º 2: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
```python
def configure_network(vmid, node, networks, pool, device_type='linux'):
    """
    –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–∏:
    - –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤—Å–µ—Ö bridge'–µ–π
    - –ü–∞–∫–µ—Ç–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
    - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ MAC-–∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è ecorouter
    - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏
    """

    # 1. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö bridge'–µ–π
    bridge_cache = {}
    for network in networks:
        bridge_name = network['bridge']
        if network.get('reserved', False):
            bridge_cache[bridge_name] = bridge_name
        else:
            bridge_cache[bridge_name] = allocate_bridge_for_network(node, bridge_name, pool)

    # 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –≤—Å–µ —Å–µ—Ç–µ–≤—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∑–∞—Ä–∞–Ω–µ–µ
    network_configs = {}

    # –û–±—Ä–∞–±–æ—Ç–∫–∞ ecorouter —É—Å—Ç—Ä–æ–π—Å—Ç–≤
    if device_type == 'ecorouter':
        mac = generate_ecorouter_mac()
        network_configs['net0'] = f'model=vmxnet3,bridge=vmbr0,macaddr={mac},link_down=1'

    # 3. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
    for i, network in enumerate(networks):
        net_id = f"net{i+1}" if device_type != 'ecorouter' else f"net{i+2}"
        bridge = bridge_cache[network['bridge']]

        if device_type == 'ecorouter':
            mac = generate_ecorouter_mac()
            network_configs[net_id] = f'model=vmxnet3,bridge={bridge},macaddr={mac}'
        else:
            network_configs[net_id] = f'model=virtio,bridge={bridge},firewall=1'

    # 4. –ü–∞–∫–µ—Ç–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
    max_retries = 3
    for attempt in range(max_retries):
        try:
            # –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—Å–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –æ–¥–Ω–∏–º –≤—ã–∑–æ–≤–æ–º API
            proxmox.nodes(node).qemu(vmid).config.post(**network_configs)
            break
        except Exception as e:
            if attempt == max_retries - 1:
                logger.error(f"–û—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏ –¥–ª—è VM {vmid}: {e}")
                return False
            time.sleep(2 ** attempt)  # –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞

    return True
```

### –ê–ª–≥–æ—Ä–∏—Ç–º 3: –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ –º–µ–∂–¥—É –Ω–æ–¥–∞–º–∏
```python
def distribute_deployment(users, nodes, config=None):
    """
    –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏:
    - –ú–Ω–æ–≥–æ—Ñ–∞–∫—Ç–æ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–æ–¥
    - –ü—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
    - –£—á–µ—Ç —à–∞–±–ª–æ–Ω–æ–≤ –∏ —Å–µ—Ç–µ–≤—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
    - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–π —à–∞–±–ª–æ–Ω–æ–≤
    """

    if not users:
        return {}

    # 1. –°–±–æ—Ä –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –Ω–æ–¥–∞—Ö
    node_metrics = {}
    for node in nodes:
        metrics = {
            'vm_count': len(proxmox.nodes(node).qemu.get()),
            'cpu_usage': get_node_cpu_usage(node),
            'memory_usage': get_node_memory_usage(node),
            'storage_available': get_node_storage_available(node),
            'network_bandwidth': estimate_network_bandwidth(node),
            'active_templates': count_active_templates(node)
        }
        node_metrics[node] = metrics

    # 2. –†–∞—Å—á–µ—Ç –≤–µ—Å–æ–≤—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –Ω–æ–¥—ã
    node_weights = calculate_node_weights(node_metrics, config)

    # 3. –ü—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
    user_resource_demand = estimate_user_resource_demand(users, config)

    # 4. –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤
    distribution = intelligent_distribution(users, nodes, node_weights, user_resource_demand)

    # 5. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–π —à–∞–±–ª–æ–Ω–æ–≤
    optimized_distribution = optimize_for_template_migration(distribution, config)

    return optimized_distribution

def calculate_node_weights(node_metrics, config):
    """–†–∞—Å—á–µ—Ç –≤–µ—Å–æ–≤—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –Ω–æ–¥ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤"""
    weights = {}

    for node, metrics in node_metrics.items():
        # –ë–∞–∑–æ–≤—ã–π –≤–µ—Å –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ VM (–º–µ–Ω—å—à–µ = –ª—É—á—à–µ)
        vm_weight = 1 / (1 + metrics['vm_count'])

        # CPU weight (–Ω–∏–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ = –≤—ã—à–µ –≤–µ—Å)
        cpu_weight = 1 / (1 + metrics['cpu_usage'])

        # Memory weight (–±–æ–ª—å—à–µ –¥–æ—Å—Ç—É–ø–Ω–æ–π –ø–∞–º—è—Ç–∏ = –≤—ã—à–µ –≤–µ—Å)
        memory_weight = 1 / (1 + (1 - metrics['memory_usage']))

        # Storage weight (–±–æ–ª—å—à–µ –º–µ—Å—Ç–∞ = –≤—ã—à–µ –≤–µ—Å)
        storage_weight = metrics['storage_available']

        # –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–µ—Å —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏
        total_weight = (vm_weight * 0.3 + cpu_weight * 0.25 +
                       memory_weight * 0.25 + storage_weight * 0.2)

        weights[node] = total_weight

    return weights

def intelligent_distribution(users, nodes, node_weights, user_demand):
    """–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –Ω–æ–¥–∞–º"""
    distribution = {node: [] for node in nodes}

    # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Å–æ–≤
    total_weight = sum(node_weights.values())
    if total_weight == 0:
        # Fallback: —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
        return fallback_distribution(users, nodes)

    normalized_weights = {node: weight/total_weight for node, weight in node_weights.items()}

    # –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —É—á–µ—Ç–æ–º –∏—Ö –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π
    for user in users:
        # –í—ã–±–æ—Ä –ª—É—á—à–µ–π –Ω–æ–¥—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        best_node = select_best_node_for_user(user, nodes, normalized_weights, user_demand)

        if best_node:
            distribution[best_node].append(user)
        else:
            # Fallback –Ω–∞ –Ω–æ–¥—É —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å—é
            least_loaded_node = min(nodes, key=lambda x: node_weights[x])
            distribution[least_loaded_node].append(user)

    return distribution

def select_best_node_for_user(user, nodes, node_weights, user_demand):
    """–í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –Ω–æ–¥—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    best_node = None
    best_score = -1

    for node in nodes:
        # –†–∞—Å—á–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –Ω–æ–¥–æ–π
        compatibility_score = calculate_user_node_compatibility(user, node, user_demand)

        # –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π score
        total_score = node_weights[node] * 0.7 + compatibility_score * 0.3

        if total_score > best_score:
            best_score = total_score
            best_node = node

    return best_node

def optimize_for_template_migration(distribution, config):
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–π —à–∞–±–ª–æ–Ω–æ–≤"""
    if not config:
        return distribution

    optimized = {node: [] for node in distribution.keys()}

    # –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ —à–∞–±–ª–æ–Ω–∞–º –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    template_requirements = analyze_template_requirements(distribution, config)

    # –ü–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤
    for node, users in distribution.items():
        if users:
            # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤ –Ω–∞ —ç—Ç–æ–π –Ω–æ–¥–µ
            template_efficiency = calculate_template_efficiency(node, users, config)

            if template_efficiency < 0.7:  # –ï—Å–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∏–∂–µ 70%
                # –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –Ω–æ–¥—ã
                moved_users = optimize_user_placement(users, node, distribution, config)
                optimized[node] = moved_users
            else:
                optimized[node] = users

    return optimized
```

## –°–¢–†–£–ö–¢–£–†–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–û–ù–ù–´–• –§–ê–ô–õ–û–í

### deployment_config.yml
```yaml
machines:
  - device_type: "linux"           # –¢–∏–ø: linux –∏–ª–∏ ecorouter
    name: "student-pc"             # –ò–º—è —Å–æ–∑–¥–∞–≤–∞–µ–º–æ–π –º–∞—à–∏–Ω—ã
    template_node: "pve1"          # –ù–æ–¥–∞ –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —à–∞–±–ª–æ–Ω
    template_vmid: 100             # VMID —à–∞–±–ª–æ–Ω–∞-–∏—Å—Ç–æ—á–Ω–∏–∫–∞
    networks:
      - bridge: "vmbr0"            # –ò–Ω—Ç–µ—Ä–Ω–µ—Ç
      - bridge: "lab-net"          # –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å
      - bridge: "**vmbr100**"      # –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    full_clone: false              # false = linked clone, true = full clone
```

### users_list.yml
```yaml
users:
  - "student1@pve"
  - "student2@pve"
  - "student3@pve"
```

### connections_config.yml
```yaml
"prod-cluster":
  host: "192.168.1.100:8006"
  user: "root@pam"
  use_token: false
  password: "encrypted_password"

"dev-cluster":
  host: "192.168.1.101:8006"
  user: "admin@pve"
  use_token: true
  token_name: "deploy-script"
  token_value: "encrypted_token"
```

## –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –£–¢–ò–õ–ò–¢–´

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (app/utils/logger.py)
```python
class Logger:
    @staticmethod
    def info(message):
        # –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

    @staticmethod
    def success(message):
        # –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —É—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

    @staticmethod
    def error(message):
        # –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏

    @staticmethod
    def warning(message):
        # –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
```

### –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ (app/utils/console.py)
```python
def emphasize(text):
    # –í—ã–¥–µ–ª–∏—Ç—å —Ç–µ–∫—Å—Ç –≤ –∫–æ–Ω—Å–æ–ª–∏ (—Ü–≤–µ—Ç, —è—Ä–∫–æ—Å—Ç—å)
    return text

def print_header(text):
    # –ù–∞–ø–µ—á–∞—Ç–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
    print(f"=== {text} ===")
```

## –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨ –†–ê–ó–†–ê–ë–û–¢–ö–ò

### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
1. –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ –∏ —Ñ–∞–π–ª–æ–≤
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —É—Ä–æ–≤–Ω—è–º–∏ (DEBUG, INFO, WARNING, ERROR)
3. –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
4. –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

### –≠—Ç–∞–ø 2: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Proxmox
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å ProxmoxManager —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
2. –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–µ—Å—Å–∏–π
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å graceful handling –ø–æ—Ç–µ—Ä–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

### –≠—Ç–∞–ø 3: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å ConfigManager —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π YAML
2. –°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π —Å –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º
3. –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π —Å versioning
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

### –≠—Ç–∞–ø 4: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å UserManager —Å –ø–∞–∫–µ—Ç–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
2. –î–æ–±–∞–≤–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø—É–ª–æ–≤ —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ —Å cascading cleanup
4. –î–æ–±–∞–≤–∏—Ç—å –∞—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –≠—Ç–∞–ø 5: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–π VMDeployer —Å –æ—á–µ—Ä–µ–¥—è–º–∏ –∑–∞–¥–∞—á
2. –î–æ–±–∞–≤–∏—Ç—å –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-—Ç—Ä–µ–∫–∏–Ω–≥–æ–º
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Å –ø–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å rollback –º–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### –≠—Ç–∞–ø 6: –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å DeploymentDistributor —Å –º–Ω–æ–≥–æ—Ñ–∞–∫—Ç–æ—Ä–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º
2. –°–æ–∑–¥–∞—Ç—å BalancedDeployer —Å –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω—ã–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏
3. –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–æ–¥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–π —à–∞–±–ª–æ–Ω–æ–≤

### –≠—Ç–∞–ø 7: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞–º–∏
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å TemplateManager —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
2. –î–æ–±–∞–≤–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é —à–∞–±–ª–æ–Ω–æ–≤ –º–µ–∂–¥—É –Ω–æ–¥–∞–º–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–µ—Ç–∏
3. –°–æ–∑–¥–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –Ω–∞ –ª–µ—Ç—É —Å fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—á–∏—Å—Ç–∫—É –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤

### –≠—Ç–∞–ø 8: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
1. –°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é —Å –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º
2. –î–æ–±–∞–≤–∏—Ç—å –Ω–∞–≤–∏–≥–∞—Ü–∏—é –º–µ–∂–¥—É –æ–ø—Ü–∏—è–º–∏ —Å –∏—Å—Ç–æ—Ä–∏–µ–π
3. –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å progress bars –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### –≠—Ç–∞–ø 9: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
1. –î–æ–±–∞–≤–∏—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–¥–∞—á
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ Proxmox API
4. –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –≠—Ç–∞–ø 10: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞
1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç–¥–µ–ª—å–Ω–æ —Å unit —Ç–µ—Å—Ç–∞–º–∏
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Ç–µ—Å—Ç–∞–º–∏
3. –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫—Ä–∞–µ–≤—ã–µ —Å–ª—É—á–∞–∏ –∏ –æ—à–∏–±–∫–∏ —Å comprehensive error handling
4. –î–æ–±–∞–≤–∏—Ç—å –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò

### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤:

```python
def check_node_resources(template_node, target_node):
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–æ–¥ –ø–µ—Ä–µ–¥ –º–∏–≥—Ä–∞—Ü–∏–µ–π"""
    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å CPU, –ø–∞–º—è—Ç–∏, —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–µ–≤—É—é —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –Ω–æ–¥–∞–º–∏
    # –í–µ—Ä–Ω—É—Ç—å True –µ—Å–ª–∏ —Ä–µ—Å—É—Ä—Å—ã –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã

def check_template_cache(cache_key, vmid):
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–µ—à–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤"""
    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —à–∞–±–ª–æ–Ω –≤ –∫–µ—à–µ
    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
    # –í–µ—Ä–Ω—É—Ç—å True –µ—Å–ª–∏ —à–∞–±–ª–æ–Ω –¥–æ—Å—Ç—É–ø–µ–Ω

def check_migration_path(source_node, target_node):
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –º–µ–∂–¥—É –Ω–æ–¥–∞–º–∏"""
    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–µ–≤—É—é —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å
    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å shared storage
    # –û—Ü–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è –º–∏–≥—Ä–∞—Ü–∏–∏
    # –í–µ—Ä–Ω—É—Ç—å True –µ—Å–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–∞

def get_node_cpu_usage(node):
    """–ü–æ–ª—É—á–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU –Ω–æ–¥—ã"""
    # –ó–∞–ø—Ä–æ—Å–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ CPU —á–µ—Ä–µ–∑ Proxmox API
    # –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ä–µ–¥–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
    # –í–µ—Ä–Ω—É—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ 0.0-1.0

def get_node_memory_usage(node):
    """–ü–æ–ª—É—á–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –Ω–æ–¥—ã"""
    # –ó–∞–ø—Ä–æ—Å–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø–∞–º—è—Ç–∏ —á–µ—Ä–µ–∑ Proxmox API
    # –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    # –í–µ—Ä–Ω—É—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ 0.0-1.0

def get_node_storage_available(node):
    """–ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è"""
    # –ó–∞–ø—Ä–æ—Å–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞—Ö
    # –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
    # –í–µ—Ä–Ω—É—Ç—å –æ–±—ä–µ–º –≤ GB

def estimate_network_bandwidth(node):
    """–û—Ü–µ–Ω–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–µ—Ç–∏ –Ω–æ–¥—ã"""
    # –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
    # –û—Ü–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é –Ω–∞–≥—Ä—É–∑–∫—É —Å–µ—Ç–∏
    # –í–µ—Ä–Ω—É—Ç—å –æ—Ü–µ–Ω–∫—É –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

def count_active_templates(node):
    """–ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –Ω–∞ –Ω–æ–¥–µ"""
    # –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —à–∞–±–ª–æ–Ω–æ–≤ –Ω–∞ –Ω–æ–¥–µ
    # –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã
    # –í–µ—Ä–Ω—É—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ

def estimate_user_resource_demand(users, config):
    """–ü—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏"""
    # –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
    # –†–∞—Å—Å—á–∏—Ç–∞—Ç—å CPU, –ø–∞–º—è—Ç—å, storage –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    # –í–µ—Ä–Ω—É—Ç—å —Å–ª–æ–≤–∞—Ä—å —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ —Ä–µ—Å—É—Ä—Å–æ–≤

def calculate_user_node_compatibility(user, node, user_demand):
    """–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –Ω–æ–¥–æ–π"""
    # –û—Ü–µ–Ω–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    # –°—Ä–∞–≤–Ω–∏—Ç—å —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ –Ω–æ–¥—ã
    # –í–µ—Ä–Ω—É—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ 0.0-1.0

def analyze_template_requirements(distribution, config):
    """–ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ —à–∞–±–ª–æ–Ω–∞–º –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è"""
    # –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–∫–∏–µ —à–∞–±–ª–æ–Ω—ã –Ω—É–∂–Ω—ã –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    # –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤
    # –í–µ—Ä–Ω—É—Ç—å –∞–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

def calculate_template_efficiency(node, users, config):
    """–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —à–∞–±–ª–æ–Ω–æ–≤ –Ω–∞ –Ω–æ–¥–µ"""
    # –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
    # –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    # –í–µ—Ä–Ω—É—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ 0.0-1.0

def optimize_user_placement(users, current_node, distribution, config):
    """–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
    # –ù–∞–π—Ç–∏ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –Ω–æ–¥—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    # –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è
    # –í–µ—Ä–Ω—É—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
```

### –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

```python
class PerformanceMetrics:
    def __init__(self):
        self.metrics = {
            'deployment_time': [],
            'template_creation_time': [],
            'network_setup_time': [],
            'user_creation_time': [],
            'api_call_count': 0,
            'error_count': 0,
            'cache_hit_rate': 0.0
        }

    def record_deployment_time(self, start_time, end_time):
        """–ó–∞–ø–∏—Å–∞—Ç—å –≤—Ä–µ–º—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è"""
        duration = end_time - start_time
        self.metrics['deployment_time'].append(duration)

    def record_api_call(self):
        """–ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –≤—ã–∑–æ–≤—ã API"""
        self.metrics['api_call_count'] += 1

    def record_error(self):
        """–ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –æ—à–∏–±–∫–∏"""
        self.metrics['error_count'] += 1

    def get_average_deployment_time(self):
        """–ü–æ–ª—É—á–∏—Ç—å —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è"""
        if not self.metrics['deployment_time']:
            return 0
        return sum(self.metrics['deployment_time']) / len(self.metrics['deployment_time'])
```

## –ö–õ–Æ–ß–ï–í–´–ï –û–°–û–ë–ï–ù–ù–û–°–¢–ò –î–õ–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### 1. –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ `**vmbr100**` –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–æ—á–Ω–æ–µ –∏–º—è bridge
- –û–±—ã—á–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ `vmbr1000+`

### 2. –î–≤–∞ —Ç–∏–ø–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **linux**: –æ–±—ã—á–Ω—ã–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã
- **ecorouter**: —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å —É–ø—Ä–∞–≤–ª—è—é—â–∏–º –ø–æ—Ä—Ç–æ–º net0 –Ω–∞ vmbr0

### 3. –õ–æ–∫–∞–ª—å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã
- –°–æ–∑–¥–∞—é—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–π –Ω–æ–¥–µ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ú–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—Ç —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫ –ø—Ä–∏ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏

### 4. –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏
- –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω –º–µ–∂–¥—É –Ω–æ–¥–∞–º–∏
- –£—á–µ—Ç —Ç–µ–∫—É—â–µ–π –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–æ–¥
- –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∏–≥—Ä–∞—Ü–∏–π —à–∞–±–ª–æ–Ω–æ–≤

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã Deploy-Stand –∏ –ø–æ–º–æ–∂–µ—Ç –ª—é–±–æ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—É –ø–æ–Ω—è—Ç—å, —á—Ç–æ –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–æ–±–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω.
